{
  "version": 3,
  "sources": ["../../geotiff/dist-module/compression/webimage.js"],
  "sourcesContent": ["import BaseDecoder from './basedecoder.js';\r\n\r\n/**\r\n * class WebImageDecoder\r\n *\r\n * This decoder uses the browsers image decoding facilities to read image\r\n * formats like WebP when supported.\r\n */\r\nexport default class WebImageDecoder extends BaseDecoder {\r\n  constructor() {\r\n    super();\r\n    if (typeof createImageBitmap === 'undefined') {\r\n      throw new Error('Cannot decode WebImage as `createImageBitmap` is not available');\r\n    } else if (typeof document === 'undefined' && typeof OffscreenCanvas === 'undefined') {\r\n      throw new Error('Cannot decode WebImage as neither `document` nor `OffscreenCanvas` is not available');\r\n    }\r\n  }\r\n\r\n  async decode(fileDirectory, buffer) {\r\n    const blob = new Blob([buffer]);\r\n    const imageBitmap = await createImageBitmap(blob);\r\n\r\n    let canvas;\r\n    if (typeof document !== 'undefined') {\r\n      canvas = document.createElement('canvas');\r\n      canvas.width = imageBitmap.width;\r\n      canvas.height = imageBitmap.height;\r\n    } else {\r\n      canvas = new OffscreenCanvas(imageBitmap.width, imageBitmap.height);\r\n    }\r\n\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.drawImage(imageBitmap, 0, 0);\r\n\r\n    // TODO: check how many samples per pixel we have, and return RGB/RGBA accordingly\r\n    // it seems like GDAL always encodes via RGBA which does not require a translation\r\n\r\n    return ctx.getImageData(0, 0, imageBitmap.width, imageBitmap.height).data.buffer;\r\n  }\r\n}\r\n"],
  "mappings": ";;;;;;AAQA,IAAqB,kBAArB,cAA6C,YAAY;AAAA,EACvD,cAAc;AACZ,UAAM;AACN,QAAI,OAAO,sBAAsB,aAAa;AAC5C,YAAM,IAAI,MAAM,gEAAgE;AAAA,IAClF,WAAW,OAAO,aAAa,eAAe,OAAO,oBAAoB,aAAa;AACpF,YAAM,IAAI,MAAM,qFAAqF;AAAA,IACvG;AAAA,EACF;AAAA,EAEA,MAAM,OAAO,eAAe,QAAQ;AAClC,UAAM,OAAO,IAAI,KAAK,CAAC,MAAM,CAAC;AAC9B,UAAM,cAAc,MAAM,kBAAkB,IAAI;AAEhD,QAAI;AACJ,QAAI,OAAO,aAAa,aAAa;AACnC,eAAS,SAAS,cAAc,QAAQ;AACxC,aAAO,QAAQ,YAAY;AAC3B,aAAO,SAAS,YAAY;AAAA,IAC9B,OAAO;AACL,eAAS,IAAI,gBAAgB,YAAY,OAAO,YAAY,MAAM;AAAA,IACpE;AAEA,UAAM,MAAM,OAAO,WAAW,IAAI;AAClC,QAAI,UAAU,aAAa,GAAG,CAAC;AAK/B,WAAO,IAAI,aAAa,GAAG,GAAG,YAAY,OAAO,YAAY,MAAM,EAAE,KAAK;AAAA,EAC5E;AACF;",
  "names": []
}
